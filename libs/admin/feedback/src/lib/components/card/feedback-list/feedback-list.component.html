<div
  class="list-container"
  [ngStyle]="
    !showFilter ? { display: 'block' } : { display: 'none', height: '0px' }
  "
>
  <div class="header">
    <div class="header__search">
      <hospitality-bot-search
        [parentFG]="parentFG"
        [globalQueries]="globalQueries"
        [feedbackType]="getFeedbackType(feedbackType)"
        [filterData]="filterData"
        (clear)="clearSearch()"
        (search)="getSearchValue($event)"
      ></hospitality-bot-search>
    </div>
    <div class="header__filter">
      <img
        src="assets/svg/Filter-Icon.svg"
        alt="filter"
        (click)="showFilter = true"
      />
    </div>
  </div>
  <hospitality-bot-tab-group
    *ngIf="!search.length"
    [listItems]="cardTabFilterItems"
    [selectedIndex]="tabFilterIdx"
    (selectedTabChange)="onSelectedTabFilterChange($event)"
  ></hospitality-bot-tab-group>
  <div
    class="body"
    [style.height]="search.length ? 'calc(100% - 64px)' : 'calc(100% - 117px)'"
    #feedbackListContainer
    (scroll)="onScroll($event)"
    *ngIf="!loading; else loader"
  >
    <ng-container *ngIf="feedbackList?.length; else noList">
      <ng-container *ngFor="let feedbackItem of feedbackList">
        <div
          class="item"
          (click)="setSelectedItem(feedbackItem)"
          [ngStyle]="
            selectedFeedback &&
            selectedFeedback.id === feedbackItem.id && { background: '#f1f1f1' }
          "
        >
          <div class="item__logo" [style.backgroundColor]="feedbackItem.color">
            {{ feedbackItem.getProfileNickName() }}
          </div>
          <div class="item__body">
            <div class="item__body__roomAndService">
              <div class="item__body__room">
                <div>
                  {{
                    feedbackItem.getTableOrRoomNo(getFeedbackType(feedbackType))
                  }}
                </div>
                <div
                  class="rating"
                  [style.background]="
                    getRatingColorCode(feedbackItem.feedback.ratings)
                  "
                >
                  {{ feedbackItem.feedback.ratings }}
                </div>
              </div>
              <div
                class="item__body__services"
                *ngIf="
                  getFeedbackType(feedbackType) === 'TRANSACTIONALFEEDBACK' &&
                    feedbackItem.feedback.services.services?.length;
                  else stayFeedback
                "
              >
                <div class="item__body__services__name">
                  {{ feedbackItem.feedback.services.services[0]?.serviceName }}
                </div>
                <div
                  class="item__body__services__length"
                  *ngIf="feedbackItem.feedback.services.services.length > 1"
                >
                  +{{ feedbackItem.feedback.services.services.length - 1 }}
                </div>
              </div>
              <ng-template #stayFeedback>
                <div
                  class="item__body__services"
                  *ngIf="feedbackItem.feedback.services?.length"
                >
                  <div class="item__body__services__name">
                    {{ feedbackItem.feedback.services[0]?.serviceName }}
                  </div>
                  <div
                    class="item__body__services__length"
                    *ngIf="feedbackItem.feedback.services.length > 1"
                  >
                    +{{ feedbackItem.feedback.services.length - 1 }}
                  </div>
                </div>
              </ng-template>
            </div>

            <div class="item__body__name">
              {{ feedbackItem.feedback.guest.getFullName() }}
            </div>
            <div class="item__body__remarks">
              <ng-container
                *ngIf="
                  feedbackItem.feedback.comments &&
                    feedbackItem.feedback.comments.length;
                  else noContent
                "
                >{{ feedbackItem.feedback.comments }}</ng-container
              >
            </div>
            <div class="item__body__status">
              <div>{{ feedbackItem.getStatus(cardTabFilterItems) }}</div>
              <div class="divider"></div>
              <div>SLA: {{ feedbackItem.getSLA() }}</div>
              <div class="divider"></div>
              <div>JD: {{ feedbackItem.jobDuration }}m</div>
            </div>
            <div class="item__body__assignee">
              <div>
                {{ feedbackItem.userName }} ({{ feedbackItem.departmentLabel }})
              </div>
              <div class="item__body__assignee__date">
                {{ feedbackItem.getTime(globalFilterService.timezone) }}
              </div>
            </div>
          </div>
        </div>
      </ng-container>
    </ng-container>
    <ng-template #noList>
      <div class="no-contact">
        <div class="no-contact__img">
          <img src="assets/svg/no_request.svg" alt="No Request" />
        </div>
        <div class="no-contact__title">
          {{ 'noList.noTitle' | translate }}
        </div>
        <div class="no-contact__description">
          {{ 'noList.noDescription' | translate }}
        </div>
      </div>
    </ng-template>
  </div>
</div>
<ng-template #noContent>---</ng-template>
<div
  class="list-container"
  [ngStyle]="
    showFilter
      ? {
          visibility: 'visible',
          marginRight: '1px solid #9eaeb8'
        }
      : { visibility: 'hidden', height: '0px', overflow: 'hidden' }
  "
>
  <hospitality-bot-feedback-list-filter
    [parentFG]="parentFG"
    [hotelId]="hotelId"
    (filterApplied)="handleFilter($event)"
    (close)="showFilter = false"
  ></hospitality-bot-feedback-list-filter>
</div>
<ng-template #loader>
  <div class="loader">
    <div class="spinner">
      <div class="bounce1"></div>
      <div class="bounce2"></div>
      <div class="bounce3"></div>
    </div>
  </div>
</ng-template>
