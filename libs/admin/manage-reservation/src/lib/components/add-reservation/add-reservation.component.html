<div [formGroup]="userForm" class="wrapper">
  <hospitality-bot-navigation-header [heading]="pageTitle" [routes]="routes">
    <ng-container>
      <hospitality-bot-button
        *ngIf="reservationFormData?.printRate && reservationId"
        label="Send Invoice"
        (onClick)="handleEmailInvoice()"
      ></hospitality-bot-button>
    </ng-container>
  </hospitality-bot-navigation-header>
  <div class="main">
    <p-accordion [multiple]="true">
      <hospitality-bot-booking-info
        [props]="{
          reservationTypes: reservationTypes,
          expandAccordion: expandAccordion,
          reservationId: reservationId,
          disabledForm: disabledForm
        }"
        [bookingSlotList]="bookingSlotList"
      ></hospitality-bot-booking-info>
      <p-accordionTab
        [selected]="expandAccordion"
        class="room-info"
        header="Room Information"
      >
        <hospitality-bot-room-iterator
          (listenChanges)="listenForFormChanges()"
          [itemValues]="roomTypeValues"
          [isPrePatchedRoomType]="isPrePatchedRoomType"
          [bookingConfig]="{
            entityId: entityId,
            isDraftBooking: isDraftBooking,
            reservationId: reservationId,
            isRouteData: isRouteData,
            isConfirmedBooking: isConfirmedBooking
          }"
        >
        </hospitality-bot-room-iterator>
      </p-accordionTab>
      <hospitality-bot-guest-information
        [reservationId]="reservationId"
      ></hospitality-bot-guest-information>
      <!-- <hospitality-bot-billing-address></hospitality-bot-billing-address> -->
      <p-accordionTab header="Special Instructions">
        <div class="form-block" formGroupName="instructions">
          <hospitality-bot-text-area
            class="full-width"
            controlName="specialInstructions"
            [props]="{
              placeholder: 'Enter'
            }"
          ></hospitality-bot-text-area>
        </div>
      </p-accordionTab>
      <hospitality-bot-payment-rule
        [reservationId]="reservationId"
        [isFullPayment]="isFullPayment"
      ></hospitality-bot-payment-rule>
      <hospitality-bot-payment-method
        [reservationId]="reservationId"
      ></hospitality-bot-payment-method>
    </p-accordion>
    <div class="bk-summary">
      <hospitality-bot-booking-summary
        [selectedOffer]="selectedOffer"
        [summaryData]="summaryData"
        [offersList]="offersList"
        (onOfferItemSelect)="offerSelect($event)"
        (onOfferSelect)="offerSelect()"
        (handleInitForm)="initForm()"
        [disabledForm]="disabledForm"
        [loadSummary]="loadSummary"
        [bookingInfo]="{
          occupancyDetails: occupancyDetails,
          externalBooking: isExternalBooking,
          offerResponse: offerResponse
        }"
      >
        <div class="bk-summary_roomInfo_checkoutInfo summary-item">
          <p class="bk-summary_roomInfo_checkoutInfo_heading">
            Checkin - Checkout
          </p>
          <p class="bk-summary_roomInfo_checkoutInfo_subText">
            {{
              reservationInfoControls.sessionType.value ===
              sessionType.DAY_BOOKING
                ? (reservationInfoControls.from.value
                  | date: 'dd/MM/yyyy hh:mm a')
                : (reservationInfoControls.from.value | date: 'dd/MM/yyyy')
            }}

            -
            {{
              reservationInfoControls.sessionType.value ===
              sessionType.DAY_BOOKING
                ? (reservationInfoControls.to.value
                  | date: 'dd/MM/yyyy hh:mm a')
                : (reservationInfoControls.to.value | date: 'dd/MM/yyyy')
            }}
          </p>
        </div>
        <div class="bk-summary_roomInfo_guestInfo summary-item">
          <p class="bk-summary_roomInfo_guestInfo_heading">
            Rooms & Guests
          </p>
          <p class="bk-summary_roomInfo_guestInfo_subText">
            {{ occupancyDetails.roomCount }}
            Room,
            {{ occupancyDetails.adultCount }}
            Adult,
            {{ occupancyDetails.childCount }}
            Kid
          </p>
        </div>
      </hospitality-bot-booking-summary>
    </div>
  </div>
</div>
