<div class="wrapper">
  <div #main [formGroup]="parentFormGroup">
    <div class="header">
      <div
        *ngFor="let field of fields"
        [style.flexBasis]="field.width ? field.width : width"
        class="header__cell"
      >
        {{ field.label }}
      </div>
    </div>
    <ng-container formGroupName="roomInformation">
      <div
        formArrayName="roomTypes"
        *ngFor="let controls of roomTypeArray.controls; let i = index"
      >
        <div [formGroupName]="i" class="values-row">
          <div
            *ngFor="let field of fields"
            [style.flexBasis]="field.width ? field.width : width"
            [style.width]="'100px'"
            [ngSwitch]="field.type"
          >
            <hospitality-bot-input
              *ngSwitchCase="'input'"
              [controlName]="field.name"
              [props]="{
                placeholder: field.placeholder,
                type: 'number',
                errorMessages: {
                  min: errorMessage(field)
                }
              }"
              [disabled]="field.disabled"
            ></hospitality-bot-input>
            <hospitality-bot-multi-select
              *ngSwitchCase="'multi-select'"
              class="multi-select dropdown-panel"
              [controlName]="field.name"
              [props]="{
                placeholder: field.placeholder,
                isAsync: false
              }"
              [options]="
                field.options
                  ? field.options
                  : controls.get('rooms').value
              "
              [disabled]="field.disabled"
              [settings]="{ showHeader: false }"
            ></hospitality-bot-multi-select>
            <hospitality-bot-select
              *ngSwitchCase="'select'"
              class="select dropdown-panel"
              [controlName]="field.name"
              [props]="{
                placeholder: field.placeholder,
                isAsync: field.isAsync
              }"
              [options]="
                field.options
                  ? field.options
                  : field.name === 'ratePlanId'
                  ? controls.get('ratePlans').value
                  : controls.get('rooms').value
              "
              [disabled]="field.disabled"
              [loading]="field.options ? loadingRoomTypes[i] : false"
            ></hospitality-bot-select>
            <hospitality-bot-quick-select
              *ngSwitchCase="'quick-select'"
              [controlName]="field.name"
              class="select dropdown-panel"
              [inputType]="'select'"
              [props]="{
                showChips: false,
                isAsync: true,
                placeholder: field.placeholder,
                selectedOption: selectedRoomTypes[i],
                emitResponse: true
              }"
              [apiConfig]="{
                entityId: entityId,
                apiEndPoint: 'inventory',
                dataModel: {
                  key: 'roomTypes'
                },
                queryParams: getConfig(),
                searchAPIEndPoint: 'library/search',
                searchModel: {
                  key: 'ROOM_TYPE'
                },
                searchQueryParams: { type: 'ROOM_TYPE' }
              }"
              [paginationConfig]="{
                isPagination: true,
                limit: 200
              }"
              (clickedOption)="roomTypeChange($event, i)"
              (missingOption)="loadMoreRoomTypes($event, i)"
              [reinitialize]="reinitializeRooms"
              [initItems]="initItems"
            ></hospitality-bot-quick-select>
          </div>
          <ng-container *ngIf="roomTypeArray.length > 1">
            <mat-icon
              class="delete"
              [ngClass]="formService.disableBtn ? 'disabled-btn' : ''"
              (click)="removeField(i)"
              >clear</mat-icon
            >
          </ng-container>
        </div>
      </div>
    </ng-container>
  </div>
  <div class="btn-wrapper">
    <hospitality-bot-button
      *ngIf="isConfirmedBooking"
      class="action-btn"
      label="Upgrade Room"
      (onClick)="upgradeRoomType()"
      [disabled]="isCheckedout"
      variant="text"
    ></hospitality-bot-button>
    <hospitality-bot-button
      class="action-btn"
      label="+ Add More Rooms"
      (onClick)="addNewField()"
      [disabled]="formService.disableBtn"
      variant="text"
    ></hospitality-bot-button>
  </div>
</div>
<!-- 
<p-dialog
  class="dialog"
  header="Room Upgrade"
  [(visible)]="openDialog"
  [style]="{ width: '60vw' }"
  [modal]="true"
  (onHide)="closeDialog()"
>
  <hospitality-bot-upgrade-room-type
    (onClose)="onCloseRoomUpgrade($event)"
    [roomConfig]="{
      entityId: entityId,
      reservationId: reservationId,
      toDate: toDate
    }"
  ></hospitality-bot-upgrade-room-type>
</p-dialog> -->
