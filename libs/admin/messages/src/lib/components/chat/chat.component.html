<div style="height: 100%;">
  <div class="guestInfoOpen" (click)="openGuestInfo()">
    <div class="guestInfoAvatar" [style.background]="selectedChat?.color">
      <img
        [src]="chat?.receiver?.profileUrl"
        *ngIf="chat?.receiver?.profileUrl; else defaultAvatar"
      />
      <ng-template #defaultAvatar
        ><div class="label">
          {{ selectedChat?.getProfileNickName() }}
        </div></ng-template
      >
    </div>
    <div class="selectedChat">
      {{ selectedChat ? selectedChat?.name || selectedChat?.phone : '' }}
    </div>
  </div>
  <div
    class="scrollChat"
    (scroll)="onScroll($event)"
    *ngIf="chatDates.length; else noChat"
    #scrollMe
  >
    <ng-container *ngFor="let date of chatDates">
      <div class="chatDate">
        {{ date }}
      </div>
      <div
        *ngFor="let message of chatList.messages[selectedChat.receiverId][date]"
        style="display: flex;"
        [ngStyle]="
          message.direction === 'OUTBOUND'
            ? { 'justify-content': 'flex-end' }
            : {}
        "
      >
        <div
          [ngClass]="
            message.direction === 'OUTBOUND' ? 'right-message' : 'left-message'
          "
          [ngStyle]="
            message.status === 'sent' ? { opacity: '1' } : { opacity: '0.5' }
          "
        >
          <div
            [ngClass]="
              message.direction === 'OUTBOUND'
                ? 'right-message__text'
                : 'left-message__text'
            "
          >
            <ng-container *ngIf="message.text; else media">
              <p [innerHTML]="message.text | linkDetector"></p>
            </ng-container>
            <ng-template #media>
              <hospitality-bot-media-chat
                [message]="message"
              ></hospitality-bot-media-chat
            ></ng-template>
          </div>
          <div class="message__time">{{ message.getTime() }}</div>
        </div>
      </div>
    </ng-container>
  </div>
  <ng-template #noChat>
    <div class="noChat"></div>
  </ng-template>
  <ng-container *ngIf="this.chatList.receiver[selectedChat.receiverId]">
    <div
      class="chatRecieve"
      *ngIf="
        chatFG && this.chatList.receiver[selectedChat.receiverId]?.enableSend;
        else noSend
      "
    >
      <div class="chatFG" [formGroup]="chatFG">
        <div class="textWrapper">
          <input
            matInput
            type="text"
            class="message-field-input"
            placeholder="Type Message"
            formControlName="message"
            (keyup)="checkForEnterKey($event)"
          />
          <img src="assets/svg/smile.svg" class="smileImg" />
        </div>
      </div>
      <div style="cursor: pointer;" (click)="sendMessage()">
        <img src="assets/svg/send-message.svg" />
      </div>
    </div>
    <ng-template #noSend>
      <div class="whatsAppRule">
        As per WhatsApp's rules, you can only respond to a user within 24 hours
        of their messages.
      </div>
    </ng-template>
  </ng-container>
</div>
