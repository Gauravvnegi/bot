<div class="guest-list-sidebar">
  <div class="sidebar-slide-header">
    <span class="title">Guest List</span>
    <span class="close-icon">
      <img
        (click)="close()"
        class="close-sidebar-icon"
        src="assets/svg/close-sidebar.svg"
      />
    </span>
  </div>

  <div class="guest-list-sidebar__content" [formGroup]="useForm">
    <div class="header">
      <div class="search-bar">
        <hospitality-bot-global-search
          [formGroup]="useForm"
          controlName="search"
          [props]="{
            placeholder: 'Search by Name',
            hasSuggestion: false
          }"
          [suggestionList]="[]"
        ></hospitality-bot-global-search>
      </div>
      <div (click)="openAddGuest()" class="add-guest">
        + Add Guest
      </div>
    </div>

    <div class="tab-group" *ngIf="!isFilterHidden">
      <hospitality-bot-tab-group
        [listItems]="seatedTabGroup"
        (selectedTabChange)="tabChange($event)"
      ></hospitality-bot-tab-group>
    </div>

    <div class="chips" *ngIf="!isFilterHidden">
      <hospitality-bot-chips
        [activeIndex]="activeIndex"
        [chips]="seatedChips"
        (changeChips)="setChip($event)"
      ></hospitality-bot-chips>
    </div>

    <div
      class="content"
      [ngStyle]="{
        height: isFilterHidden ? 'calc(100vh - 124px)' : 'calc(100vh - 250px)'
      }"
      infiniteScroll
      (scrolled)="loadMore()"
      [toggleScrollListener]="paginationDisabled"
    >
      <ng-container
        *ngTemplateOutlet="isSeated ? seated : waitlisted"
      ></ng-container>
    </div>
  </div>
</div>

<ng-template #emptyGuest>
  <hospitality-bot-loader-bounce
    *ngIf="loading; else empty"
  ></hospitality-bot-loader-bounce>
  <ng-template #empty>
    <div class="empty-container">
      <div class="content">
        <img [src]="'assets/svg/no guest found.svg'" alt="" />
        <span class="title">No Guest Found</span>
      </div>
    </div>
  </ng-template>
</ng-template>

<p-sidebar
  class="sidebar-slide"
  [(visible)]="sidebarVisible"
  position="right"
  [style]="{ width: '500px' }"
  [dismissible]="true"
  [showCloseIcon]="false"
>
  <ng-container #sidebarSlide></ng-container>
</p-sidebar>

<ng-template #seated>
  <ng-container *ngIf="!loading && seatedGuestList.length; else emptyGuest">
    <ng-container
      *ngFor="let guest of seatedGuestList; let i = index; trackBy: trackGuests"
    >
      <hospitality-bot-guest-card
        [item]="guest"
        (click)="onEditGuestReservation(guest)"
      >
        <ng-container>
          <hospitality-bot-button
            label="Print Invoice"
            variant="outlined"
            (onClick)="onPrintInvoice($event)"
          ></hospitality-bot-button>
          <hospitality-bot-button
            label="Change Table"
            variant="outlined"
            (onClick)="onTableChange($event, guest)"
          ></hospitality-bot-button>
        </ng-container>
      </hospitality-bot-guest-card>
    </ng-container>
  </ng-container>
</ng-template>

<ng-template #waitlisted>
  <ng-container *ngIf="!loading && waitlistedDate; else emptyGuest">
    <ng-container *ngFor="let key of waitlistedDate">
      <ng-container>
        <div class="date__divider">
          {{ key }}
        </div>
      </ng-container>
      <ng-container
        *ngFor="
          let guest of waitListGuestList[key];
          let i = index;
          trackBy: trackGuests
        "
      >
        <hospitality-bot-guest-card
          [item]="guest"
          (click)="onEditGuestReservation(guest)"
        >
          <ng-container>
            <hospitality-bot-button
              label="Notified"
              variant="outlined"
            ></hospitality-bot-button>
            <hospitality-bot-button
              label="Seated"
              variant="outlined"
              (onClick)="handelQuickCTA($event, guest, 'SEATED')"
            ></hospitality-bot-button>
            <hospitality-bot-button
              label="Cancel"
              variant="outlined"
              (onClick)="handelQuickCTA($event, guest, 'DELETE')"
            ></hospitality-bot-button>
          </ng-container>
        </hospitality-bot-guest-card>
      </ng-container>
    </ng-container>
  </ng-container>
</ng-template>
