<div class="wrapper">
  <header class="wrapper-header">
    <div class="back">
      <mat-icon (click)="goback()" class="material-icons" matSuffix
        >keyboard_backspace</mat-icon
      >
      <p class="label">
        View {{ userForm.get('firstName').value }}
        {{ userForm.get('lastName').value }} Details
      </p>
    </div>
    <div class="edit-wrapper">
      <div class="manage-box">
        <p>
          Manage By : {{ managedBy.firstName }} {{ managedBy.lastName }},
          {{ managedBy.jobTitle }}
        </p>
      </div>
      <!-- <p class="text">Edit user</p> -->
    </div>
  </header>
  <form [formGroup]="userForm">
    <div class="wrapper-form">
      <div class="fields">
        <div class="field width-half">
          <mat-label class="mat-label">First Name :</mat-label>
          <mat-form-field>
            <input
              class="input-field"
              formControlName="firstName"
              type="text"
              placeholder=""
              matInput
              spellcheck="false"
            />
            <mat-error
              *ngIf="
                userForm.get('firstName').touched &&
                userForm.get('firstName').hasError('required')
              "
            >
              First name is required
            </mat-error>
          </mat-form-field>
        </div>
        <div class="field width-half">
          <mat-label class="mat-label">Last Name :</mat-label>
          <mat-form-field>
            <input
              class="input-field"
              formControlName="lastName"
              type="text"
              placeholder=""
              matInput
              spellcheck="false"
            />
          </mat-form-field>
        </div>
        <div class="field width-half">
          <mat-label class="mat-label">Product Type :</mat-label>
          <mat-form-field>
            <mat-select formControlName="productType" multiple>
              <mat-option
                *ngFor="let product of productTypeList"
                [value]="product.value"
                >{{ product.value }}</mat-option
              >
            </mat-select>
            <mat-error
              *ngIf="
                userForm.get('productType').touched &&
                userForm.get('productType').hasError('required')
              "
            >
              Product Type is required
            </mat-error>
          </mat-form-field>
        </div>
      </div>
      <div class="fields">
        <div class="field width-half">
          <mat-label class="mat-label">Dept :</mat-label>
          <mat-form-field>
            <mat-select formControlName="deptName" multiple>
              <mat-option
                *ngFor="let product of productTypeList"
                [value]="product"
                >{{ product }}</mat-option
              >
            </mat-select>
            <mat-error
              *ngIf="
                userForm.get('deptName').touched &&
                userForm.get('deptName').hasError('required')
              "
            >
              Deparment Name is required
            </mat-error>
          </mat-form-field>
        </div>
        <div class="field width-half">
          <mat-label class="mat-label">Job Title :</mat-label>
          <mat-form-field>
            <input
              class="input-field"
              formControlName="jobTitle"
              type="text"
              placeholder=""
              matInput
              spellcheck="false"
            />
            <mat-error
              *ngIf="
                userForm.get('jobTitle').touched &&
                userForm.get('jobTitle').hasError('required')
              "
            >
              Job title is required
            </mat-error>
          </mat-form-field>
        </div>
        <div class="field width-half">
          <mat-label class="mat-label">Hotel :</mat-label>
          <mat-form-field>
            <mat-select formControlName="branchName">
              <!-- <option value="" selected>None</option> -->
              <mat-option
                *ngFor="let branch of branchNames"
                [value]="branch.value"
                >{{ branch.label }}</mat-option
              >
            </mat-select>
            <mat-error
              *ngIf="
                userForm.get('branchName').touched &&
                userForm.get('branchName').hasError('required')
              "
            >
              Hotel name is required
            </mat-error>
          </mat-form-field>
        </div>
      </div>
      <div class="fields">
        <div class="field width-half">
          <mat-label class="mat-label">Phone# :</mat-label>
          <mat-form-field class="phone-no-dropdown">
            <mat-select
              formControlName="cc"
              (selectionChange)="change($event)"
              (openedChange)="openedChange($event)"
            >
              <!-- <option value="" selected>None</option> -->
              <ng-container
                *ngIf="!isOptionsOpenedChanged; else optionsChanged"
              >
                <mat-option
                  *ngFor="let country of countries; trackBy: trackByFn"
                  [value]="country.value"
                  >{{ country.value }}</mat-option
                >
              </ng-container>

              <ng-template #optionsChanged>
                <ng-container
                  *ngIf="!(onOpenedChange | async); else opendOptions"
                >
                  <mat-option
                    *ngFor="let country of countries; trackBy: trackByFn"
                    [value]="country.value"
                    >{{ country.value }}</mat-option
                  >
                </ng-container>

                <ng-template #opendOptions>
                  <mat-option
                    *ngFor="let country of countries; trackBy: trackByFn"
                    [value]="country.value"
                    >{{ country.label }}</mat-option
                  >
                </ng-template>
              </ng-template>
            </mat-select>
          </mat-form-field>
          <mat-form-field class="phone-no-field">
            <input
              formControlName="phoneNumber"
              class="input-field"
              type="text"
              placeholder=""
              matInput
              spellcheck="false"
            />
          </mat-form-field>
        </div>
        <div class="field width-half">
          <mat-label class="mat-label">Brand :</mat-label>
          <mat-form-field>
            <mat-select formControlName="brandName">
              <!-- <option value="" selected>None</option> -->

              <mat-option
                *ngFor="let brandName of brandNames"
                [value]="brandName.value"
                >{{ brandName.label }}
              </mat-option>
            </mat-select>
            <mat-error
              *ngIf="
                userForm.get('brandName').touched &&
                userForm.get('brandName').hasError('required')
              "
            >
              Brand name is required
            </mat-error>
          </mat-form-field>
        </div>
        <div class="field width-half">
          <div class="mat-label">Team :</div>
          <div class="member">
            <div
              *ngFor="let item of teamMember; let index = index"
              (click)="openTableModal()"
            >
              <div
                class="member-name"
                [style.margin-left]="'calc(indexpx + 48px)'"
                *ngIf="index < 3"
              >
                {{ item }}
              </div>
            </div>
          </div>
          <div>+ {{ teamMember.length - 3 }}</div>
        </div>
      </div>
      <div class="fields">
        <div class="field width-half">
          <mat-label class="mat-label">Email ID :</mat-label>
          <mat-form-field>
            <input
              formControlName="email"
              class="input-field"
              type="text"
              placeholder=""
              matInput
              spellcheck="false"
            />
            <mat-error
              *ngIf="
                userForm.get('email').touched &&
                userForm.get('email').hasError('required')
              "
            >
              Email is required
            </mat-error>
            <mat-error
              *ngIf="
                userForm.get('email').touched &&
                userForm.get('email').hasError('pattern')
              "
            >
              Please enter the valid Email
            </mat-error>
          </mat-form-field>
        </div>
      </div>
      <div class="fields image-wrapper">
        <div class="image">
          <hospitality-bot-upload-file
            [fileUploadData]="'Image'"
            [url]="userProfileUrl"
            [isDisable]="false"
            (fileData)="uploadProfile($event)"
          >
          </hospitality-bot-upload-file>
        </div>
        <img class="material-icons" src="assets/svg/edit.svg" />
        <img
          class="material-icons"
          src="assets/svg/delete.svg"
          (click)="deleteFile()"
        />
      </div>
      <div class="fields margin-adjust">
        <div class="image-button">
          <mat-label class="text">Image :</mat-label>
          <button class="button">
            Choose File
          </button>
          <!-- <p class="image-name">John.jpg</p> -->
        </div>
      </div>
      <div class="fields margin-adjust">
        <div class="note">
          Recommended dimension (in px) : 60*60
        </div>
      </div>
    </div>
    <pre>
      <!-- {{ userForm.getRawValue() | json }} -->

    </pre>

    <!-- ****************Permission Wrapper**************** -->
    <div class="wrapper-manage-permission">
      <div class="header">
        Manage Permissions
        <div (click)="addUser()" class="add-user">
          + Add New User
        </div>
      </div>
      <div *ngIf="productTypeList" class="tabs">
        <hospitality-bot-tab-group
          [listItems]="productTypeList"
          [selectedIndex]="tabFilterIdx"
        ></hospitality-bot-tab-group>
      </div>

      <div class="permission-table-header">
        <div class="left-table">
          <div class="image">
            <img src="assets/svg/roles.svg" />
          </div>
          <p class="left-table-header">Entity</p>
          <p
            *ngFor="
              let userPermissionFG of permissionConfigsFA['controls'];
              let oddIdx = odd
            "
            class="left-table-entity"
            [ngClass]="oddIdx ? 'color-added' : ''"
          >
            {{ userPermissionFG.get('label').value }}
          </p>
          <!-- <p class="left-table-entity color-added">
            Arrival(Pre-checkin/ Checkin)
          </p> -->
        </div>
        <div class="right-table">
          <div class="box-wrapper">
            <div class="box">
              <p class="label">View</p>
              <p class="paragraph">View General & Sensitive Info</p>
              <div class="float-box">
                <img src="assets/svg/View.svg" />
              </div>
            </div>
            <div class="box">
              <p class="label">Manage</p>
              <p class="paragraph">Create/Delete/Edit Source of Data</p>
              <div class="float-box">
                <img src="assets/svg/Manage.svg" />
              </div>
            </div>
            <!-- <div class="box">
              <p class="label">Actions(User Submission)</p>
              <p class="paragraph">
                Approve/Reject (By Default includes sensitive info)o
              </p>
              <div class="float-box">
                <img src="assets/svg/Action.svg" />
              </div>
            </div> -->
          </div>
          <div formArrayName="permissionConfigs">
            <div
              *ngFor="
                let userPermissionFG of permissionConfigsFA['controls'];
                let oddIdx = odd;
                let userPermissionIdx = index
              "
              [ngClass]="oddIdx ? 'color-added' : ''"
            >
              <div formGroupName="{{ userPermissionIdx }}">
                <div formGroupName="permissions" class="checkbox-wrapper">
                  <mat-checkbox
                    formControlName="view"
                    [checked]="
                      userPermissionFG.get('permissions').get('view').value ===
                      1
                        ? true
                        : false
                    "
                  ></mat-checkbox>
                  <mat-checkbox
                    formControlName="manage"
                    [checked]="
                      userPermissionFG.get('permissions').get('manage').value ==
                      1
                        ? true
                        : false
                    "
                  ></mat-checkbox>
                  <!-- <mat-checkbox formControlName="action" [checked]="
                      userPermissionFG.get('permissions').get('action').value ==
                      1
                        ? true
                        : false
                    "></mat-checkbox> -->
                </div>
              </div>
            </div>
          </div>
          <!-- <div class="checkbox-wrapper color-added">
            <mat-checkbox></mat-checkbox>
            <mat-checkbox [disabled]="true"></mat-checkbox>
            <mat-checkbox></mat-checkbox>
          </div> -->
        </div>
      </div>
      <div class="permission-button-wrapper">
        <button (click)="savePermission()">
          <i *ngIf="isUpdatingPermissions" class="fa fa-spinner fa-spin"></i>
          {{ isUpdatingPermissions ? 'Updating User Permissions' : 'Save' }}
        </button>
      </div>
    </div>
  </form>
</div>

<!-- <pre>
    {{ value | json }}
 
  </pre> -->
