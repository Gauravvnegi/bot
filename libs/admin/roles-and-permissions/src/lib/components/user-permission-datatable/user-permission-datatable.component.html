<div class="details_wrapper">
  <div class="header">
    <div (click)="closeModal()" class="close">
      <i class="fa fa-times" aria-hidden="true"></i>
    </div>
  </div>
  <div class="table-container">
    <p-table
      #dt
      [styleClass]="tableConfig.styleClass"
      [resizableColumns]="isResizableColumns"
      [autoLayout]="isAutoLayout"
      [loading]="loading"
      [columns]="cols"
      [value]="values"
      [paginator]="isPaginaton"
      [rows]="rowsPerPage"
      [showCurrentPageReport]="showCurrentPageReport"
      [rowsPerPageOptions]="rowsPerPageOptions"
      currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries"
      [(first)]="first"
      [totalRecords]="totalRecords"
      [filterDelay]="0"
      [(selection)]="selectedRows"
      (onRowSelect)="onRowSelect($event)"
      (onRowUnselect)="onRowUnselect($event)"
      (sortFunction)="customSort($event)"
      [customSort]="isCustomSort"
    >
      <ng-template pTemplate="caption">
        <div class="caption__wrapper">
          <form [formGroup]="tableFG">
            <div class="caption__wrapper--tabmenu">
              <div class="header">
                <div class="userPermissionTableName">
                  <p class="heading">{{ tableName }}</p>
                </div>
                <div class="action-wrapper">
                  <hospitality-bot-export-list
                    (onDocumentActions)="onDocumentActions()"
                    [documentTypes]="documentTypes"
                    [documentActionTypes]="documentActionTypes"
                  ></hospitality-bot-export-list>
                </div>
              </div>
              <div *ngIf="isTabFilters && tabFilterItems" class="tabs">
                <hospitality-bot-tab-group
                  [listItems]="tabFilterItems"
                  [selectedIndex]="tabFilterIdx"
                  (selectedTabChange)="onSelectedTabFilterChange($event)"
                ></hospitality-bot-tab-group>
              </div>
            </div>
            <hospitality-bot-filter-chips
              *ngIf="isQuickFilters"
              [chips]="tabFilterItems[tabFilterIdx].chips"
              (onChange)="toggleQuickReplyFilter($event)"
            ></hospitality-bot-filter-chips>
          </form>
        </div>
      </ng-template>

      <ng-template pTemplate="emptymessage">
        <hospitality-bot-empty-view></hospitality-bot-empty-view>
      </ng-template>
      <!-- *******************************HEADER WITH SEARCH******************************* -->
      <ng-template pTemplate="header" let-columns>
        <tr>
          <th class="userTableHead" pResizableColumn>
            <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
          </th>
          <th
            class="table-data-head"
            pResizableColumn
            [pSortableColumn]="col.field"
            *ngFor="let col of columns"
          >
            <div>
              <p class="table-header-text">{{ col.header }}</p>
              <p-sortIcon *ngIf="col.isSort" [field]="col.field"></p-sortIcon>
            </div>
          </th>
        </tr>

        <tr class="table-search-head">
          <th class="table-search-head"></th>
          <th class="table-search-head">
            <input
              pInputText
              type="text"
              (input)="onFilterTypeTextChange($event.target.value, 'firstName')"
              class="p-column-filter"
            />
          </th>
          <th class="table-search-head">
            <input
              pInputText
              type="text"
              (input)="
                onFilterTypeTextChange(
                  $event.target.value,
                  'booking.bookingNumber'
                )
              "
              class="p-column-filter"
              disabled="true"
            />
          </th>
          <th class="table-search-head">
            <input
              pInputText
              type="text"
              (input)="
                onFilterTypeTextChange(
                  $event.target.value,
                  'guests.primaryGuest.firstName'
                )
              "
              class="p-column-filter"
              disabled="true"
            />
          </th>
        </tr>
      </ng-template>
      <!-- **************************************BODY********************************* -->
      <ng-template
        pTemplate="body"
        let-rowData
        let-columns="columns"
        let-rowIndex="rowIndex"
      >
        <tr class="data-table-row" (click)="openUserDetails(rowData)">
          <td class="table--checkbox">
            <p-tableCheckbox
              [value]="rowData"
              [index]="rowIndex"
              (click)="onCheckboxClicked($event)"
            ></p-tableCheckbox>
          </td>
          <td class="name">
            <div class="data">
              {{ rowData.getFullName() }}
              <p>{{ rowData.getContactDetails() }}</p>
              <p>{{ rowData.email }}</p>
            </div>
          </td>
          <td class="brand-name">
            {{ rowData.getBrandAndBranchName() }}
            <p>{{ rowData.jobTitle }}</p>
          </td>

          <td class="">
            <label (click)="onCheckboxClicked($event)" class="switch">
              <input type="checkbox" [checked]="rowData.status" />
              <mat-slide-toggle
                [checked]="rowData.status"
                (change)="updateRolesStatus($event, rowData)"
                [disabled]="tabFilterItems[tabFilterIdx].value === 'ALL'"
              >
              </mat-slide-toggle>
            </label>
          </td>
        </tr>
      </ng-template>
      <!-- *********************************FOOTER******************************* -->
      <ng-template pTemplate="summary">
        <p-paginator
          [rows]="rowsPerPage"
          [totalRecords]="totalRecords"
          [rowsPerPageOptions]="rowsPerPageOptions"
          (onPageChange)="paginate($event)"
        ></p-paginator>
      </ng-template>
    </p-table>
  </div>
</div>
