<mat-horizontal-stepper [@.disabled]="true" #stepper>
  <mat-step></mat-step>
  <mat-step></mat-step>
  <mat-step></mat-step>
</mat-horizontal-stepper>
<ng-container [ngSwitch]="stepper?.selectedIndex">
  <div class="wrapper" *ngSwitchCase="0">
    <header class="wrapper-header">
      <div class="back">
        <mat-icon class="material-icons" matSuffix (click)="goBack()"
          >keyboard_backspace</mat-icon
        >
        <p class="label">
          <ng-container *ngIf="templateId; else addTemplate">
            {{ 'templateForm.editTemplate' | translate }}
          </ng-container>
          <ng-template #addTemplate>
            {{ 'templateForm.createTemplate' | translate }}
          </ng-template>
        </p>
      </div>
    </header>
    <form [formGroup]="templateForm">
      <div class="wrapper-form">
        <div class="fields">
          <div class="field">
            <mat-label class="mat-label">Name:</mat-label>
            <mat-form-field class="input">
              <input
                matInput
                placeholder="Enter Template Name"
                formControlName="name"
              />
              <mat-error
                *ngIf="
                  templateForm.get('name').touched &&
                  templateForm.get('name').hasError('required')
                "
              >
                Name is required
              </mat-error>
            </mat-form-field>
          </div>
          <div class="field">
            <hospitality-bot-topic-dropdown
              [name]="'topicId'"
              [parentForm]="templateForm"
              [hotelId]="hotelId"
              [id]="true"
              [state]="templateId ? 'ALL' : 'ACTIVE'"
            ></hospitality-bot-topic-dropdown>
          </div>
        </div>
        <div class="fields">
          <mat-label class="mat-description">Description:</mat-label>
          <mat-form-field class="description">
            <input
              matInput
              placeholder="Write Your Description Here"
              formControlName="description"
            />
          </mat-form-field>
        </div>
      </div>

      <ng-container *ngIf="htmlTemplate?.value; else createContent">
        <div class="wrapper-text">
          <div class="add-text">
            Edit Content
          </div>
          <div class="manually-add">
            <div class="manually-templates">
              <div class="manually-import">
                <div [innerHTML]="htmlTemplate?.value"></div>
              </div>
              <div class="logos">
                <div
                  class="logos__logo"
                  mat-raised-button
                  (click)="moveToEditor(true)"
                >
                  <img
                    [src]="templateConfiguration.images.view.url"
                    [alt]="templateConfiguration.images.view.alt"
                  />
                </div>
                <div
                  class="logos__logo"
                  mat-raised-button
                  (click)="moveToEditor(false)"
                >
                  <img
                    [src]="templateConfiguration.images.edit.url"
                    [alt]="templateConfiguration.images.edit.alt"
                  />
                </div>
                <div class="logos__logo" (click)="deleteTemplate()">
                  <img
                    [src]="templateConfiguration.images.delete.url"
                    [alt]="templateConfiguration.images.delete.alt"
                  />
                </div>
              </div>
            </div>
          </div>
        </div>
      </ng-container>
      <ng-template #createContent>
        <div class="wrapper-text">
          <div class="add-text">
            Create Content
          </div>
          <div class="manually-add">
            <div
              class="manually-templates"
              mat-raised-button
              (click)="openCreateContent(false, 'SAVEDTEMPLATE')"
            >
              <img
                [src]="templateConfiguration.images.saved.url"
                [alt]="templateConfiguration.images.saved.alt"
              />
              <div class="manually-import">
                {{ 'createContent.savedTemplate' | translate }}
              </div>
            </div>
            <div
              class="manually-templates"
              mat-raised-button
              (click)="openCreateContent(false, 'PREDESIGNTEMPLATE')"
            >
              <img
                class="built-template"
                [src]="templateConfiguration.images.inbuilt.url"
                [alt]="templateConfiguration.images.inbuilt.alt"
              />
              <div class="manually-import">
                {{ 'createContent.inBuiltTemplate' | translate }}
              </div>
            </div>
            <div
              class="manually-templates"
              mat-raised-button
              (click)="openCreateContent(true)"
            >
              <img
                class="built-template"
                [src]="templateConfiguration.images.editTemplate.url"
                [alt]="templateConfiguration.images.editTemplate.alt"
              />
              <div class="manually-import">
                {{ 'createContent.createNew' | translate }}
              </div>
            </div>
          </div>
        </div>
      </ng-template>

      <div class="wrapper-form">
        <div class="fields">
          <div class="toggle_wrapper">
            <mat-label class="mat-label">Active :</mat-label>
            <div class="status status--left">Disable</div>
            <mat-slide-toggle formControlName="status"></mat-slide-toggle>
            <div class="status status--right">Enable</div>
          </div>
        </div>
      </div>
      <div class="save-section">
        <div
          class="save-button"
          (click)="handleSubmit($event)"
          [ngClass]="{ active: !isSaving, disabled: isSaving }"
        >
          <div class="save-text">
            <i *ngIf="isSaving" class="fa fa-spinner fa-spin"></i>
            {{ isSaving ? 'Saving' : 'Save' }}
          </div>
        </div>
      </div>
    </form>
  </div>
  <div *ngSwitchCase="1">
    <hospitality-bot-template-list-container
      (change)="handleTemplateListChange($event)"
      [hotelId]="hotelId"
      [templateForm]="templateForm"
      [templateType]="typeOfTemplate"
    ></hospitality-bot-template-list-container>
  </div>
  <hospitality-bot-template-html-editor
    *ngSwitchCase="2"
    [isDisabled]="contentNotEditable"
    [openEditor]="stepper.selectedIndex == 2"
    [templateForm]="templateForm"
    [template]="template"
    [templateId]="templateId"
    (goBack)="handleBackFromEditor()"
    (saveTemplate)="handleSubmit($event)"
  ></hospitality-bot-template-html-editor>
</ng-container>
