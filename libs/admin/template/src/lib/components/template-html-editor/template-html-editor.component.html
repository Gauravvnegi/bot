<div class="wrapper">
  <header class="wrapper-header">
    <div class="back">
      <mat-icon class="material-icons" matSuffix (click)="back()"
        >keyboard_backspace</mat-icon
      >
      <p class="label">
        <ng-container *ngIf="isDisabled; else editTemplate">
          {{ 'viewTemplate' | translate }}
        </ng-container>
        <ng-template #editTemplate>
          {{ templateId ? 'Edit' : 'Create' }} Template
        </ng-template>
      </p>
    </div>
  </header>
  <form [formGroup]="templateForm">
    <div class="wrapper-form">
      <div class="fields">
        <div class="field">
          <mat-label class="mat-label">{{
            'formFieldLabels.name' | translate
          }}</mat-label>
          <mat-form-field>
            <input
              matInput
              placeholder="Enter Template Name"
              formControlName="name"
            />
            <mat-error
              *ngIf="
                templateForm.get('name').touched &&
                templateForm.get('name').hasError('required')
              "
            >
              {{ 'validationMessage.name' | translate }}
            </mat-error>
          </mat-form-field>
        </div>
        <div class="field">
          <div class="import-assets" (click)="assetImportEnable($event)">
            <img
              class="import-image"
              [src]="templateConfiguration.images.import.url"
              [alt]="templateConfiguration.images.import.alt"
            />
            {{ 'importAsset' | translate }}
          </div>
          <div *ngIf="enableAssetImport" class="asset-enable">
            <hospitality-bot-import-asset
              (closeImport)="enableAssetImport = false"
            ></hospitality-bot-import-asset>
          </div>
        </div>
      </div>
      <div class="fields" *ngIf="!isDisabled">
        <div class="field">
          <mat-label class="mat-label">{{
            'sharedTemplates' | translate
          }}</mat-label>
          <mat-checkbox formControlName="isShared"></mat-checkbox>
        </div>
      </div>
      <div class="description" *ngIf="!isDisabled">
        {{ 'descriptionMessage' | translate }}
      </div>
    </div>
    <div class="wrapper-editor">
      <hospitality-bot-template-editor
        *ngIf="openEditor"
        [parentFG]="templateForm"
        [name]="'htmlTemplate'"
        [template]="template"
        [hybrid]="false"
        [disabled]="isDisabled"
      ></hospitality-bot-template-editor>
    </div>
  </form>
  <div class="save-section" *ngIf="!isDisabled">
    <div class="save-button" (click)="saveAndPreview()" *ngIf="templateId">
      <div class="save-text">
        {{ 'editTemplateButtons.preview&Save' | translate }}
      </div>
    </div>
    <div class="save-button" (click)="save()" *ngIf="templateId">
      <div class="save-text">
        {{ 'editTemplateButtons.saveChanges' | translate }}
      </div>
    </div>
    <div
      class="preview"
      (click)="saveAndNext()"
      [ngClass]="{ active: !isSaving, disabled: isSaving }"
    >
      <div class="view">
        <i *ngIf="isSaving" class="fa fa-spinner fa-spin"></i>
        {{ 'editTemplateButtons.save&Next' | translate }}
      </div>
    </div>
  </div>
</div>
