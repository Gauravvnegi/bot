<div
  [formGroup]="parentForm"
  [ngClass]="defaultClasses.fieldMainWrapperClasses"
  [style]="settings.style"
>
  <mat-label [ngClass]="defaultClasses.fieldMasterLabelClasses">{{
    settings.master_label
  }}</mat-label>

  <div [ngClass]="defaultClasses.fieldParentWrapperClasses">
    <mat-form-field
      [ngClass]="defaultClasses.fieldContainerWrapperClasses"
      [style]="settings.style"
    >
      <mat-label [ngClass]="defaultClasses.fieldLabelContainerClasses"
        >{{ settings.label
        }}<span class="required" *ngIf="settings.required">*</span></mat-label
      >
      <mat-select
        matNativeControl
        (selectionChange)="change($event)"
        (openedChange)="openedChange($event)"
        [formControlName]="name"
        [ngClass]="defaultClasses.fieldClasses"
      >
        <ng-container
          *ngIf="!settings.isOptionsOpenedChanged; else optionsChanged"
        >
          <mat-option
            *ngFor="let option of settings.options; trackBy: trackByFn"
            [value]="option.key"
            >{{ option.value }}</mat-option
          >
        </ng-container>

        <ng-template #optionsChanged>
          <ng-container *ngIf="!(onOpenedChange | async); else opendOptions">
            <mat-option
              *ngFor="let option of settings.optionsClosed; trackBy: trackByFn"
              [value]="option.key"
              >{{ option.value }}</mat-option
            >
          </ng-container>

          <ng-template #opendOptions>
            <mat-option
              *ngFor="let option of settings.optionsOpened; trackBy: trackByFn"
              [value]="option.key"
              >{{ option.value }}</mat-option
            >
          </ng-template>
        </ng-template>
      </mat-select>
      <mat-error>{{ errorMsg }}</mat-error>
    </mat-form-field>
  </div>
</div>
